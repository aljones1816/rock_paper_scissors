<html>
   <body>
      <script>

         var compPlay; // create a variable containing the computer's choice by generating a random number between 1-3 and assigning 1-3 to a choice.
         function computerPlay() {
            
            function getRandomInt(max) {
                return Math.floor(Math.random() * Math.floor(max));
            }
         
            var numRan = getRandomInt(3);
            if (numRan == 0) {
                compPlay = 'Rock';
            } else if (numRan == 1) {
                compPlay = 'Paper';
            } else {
                compPlay = 'Scissors';
            }
         
            return (compPlay);
         };
         
         function rockPapSciss(playerSelection) {

             // compare the player's choice against the computers and assign points - 1 for player win, -1 for computer, 0 for tie
            var newPlay = playerSelection.toUpperCase();
            var compSelect = computerPlay();
            if (newPlay == 'ROCK') {
                if (compSelect == 'Rock') {
                    return (0);
                } else if (compSelect == 'Paper') {
                    return (-1);
                } else {
                    return (1);
                }
            } else if (newPlay == 'PAPER') {
                if (compSelect == 'Rock') {
                    return (1)
                } else if (compSelect == 'Paper') {
                    return (0);
                } else {
                    return (-1);
                }
            } else if (newPlay == 'SCISSORS') {
                if (compSelect == 'Rock') {
                    return (-1)
                } else if (compSelect == 'Paper') {
                    return (1);
                } else {
                    return (0);
                }
            } else {
                return ('Invalid Entry!')
            }
         }
         
         function game(numRounds) {
            var finScore = []; // array containing the round scores - used to determine final score
            
            // function to turn a point score into a string for win, lose, or tie
            function scorer(gameScore) {
                if (gameScore > 0) {
                    return ('won');
                } else if (gameScore < 0) {
                    return ('lost');
                } else {
                    return ('tied');
                }
            }

            var lastRound = 'Input your first choice!';

            for (i = 0; i < numRounds; i++ ) {

            var validInput = ['rock', 'paper','scissors']; // used to test whether player has entered a valid choice
            var useInput = '';
            
            function getInput() {
            useInput = window.prompt(lastRound);
        
            // if the player enters an invalid choice, make them choose again
            if (!validInput.includes(useInput.toLowerCase())) {
                lastRound = 'Oops! That wasn\'t a valid choice. Try typing "rock," "paper," or "scissors"';
                getInput();
            }
            
            }
            getInput();

            // calls the play function to get a score for the round
            var game = rockPapSciss(useInput);
            finScore.push(game);
            lastRound= 'You ' + scorer(finScore[i]) + ' that round! You chose ' + useInput + ' and Computer chose ' + compPlay +'. Input your next choice!';
            
            }    
         
            // Calculate the sum of the round scores 
            var finScore = finScore.reduce(function(a,b) {
                return a+b;
            }, 0)
         
            if (finScore > 2) {
                return ('OMG YOU WIN!')
            } else if (finScore < 2) {
                return ('YOU LOSE')
            } else {
                return ('THE GAME IS A TIE')
            }
         }
         
         
         // Initiates a game and at the end of a game asks if the player wants another one.
         function playGame() {
         var getAnswer = window.confirm(game(5) + '. Want to play again?');
         if (getAnswer) {
           playGame();
         };
         }
         playGame();
         
      </script>
   </body>
</html>